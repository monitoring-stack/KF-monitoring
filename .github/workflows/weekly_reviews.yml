name: Weekly Google Reviews

on:
  # a) automaticky každý pátek 05:30 UTC (≈ 06:30/07:30 podle času)
  schedule:
    - cron: "30 5 * * FRI"
  # b) ruční spuštění z Actions
  workflow_dispatch: {}

jobs:
  weekly-google-reviews:
    runs-on: ubuntu-latest

    env:
      TIMEZONE: Europe/Berlin
      # JSON string se statistikami, které jsi uložila jako secret
      WEEKLY_REVIEWS_JSON: ${{ secrets.WEEKLY_REVIEWS_JSON }}
      # stejné secrety jako u denního reportu
      RESEND_API_KEY: ${{ secrets.RESEND_API_KEY }}
      EMAIL_FROM: ${{ secrets.EMAIL_FROM }}
      EMAIL_TO: ${{ secrets.EMAIL_TO }}

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          pip install --upgrade pip

      - name: Weekly Google Reviews
        run: |
          python weekly_reviews.py
